<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Business Pitch Scoring Rubric</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f7f7f7;
        }

        h1 {
            text-align: center;
        }

        form {
            max-width: 900px;
            margin: 0 auto;
            background-color: #ffffff;
            padding: 20px 30px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0,0,0,0.05);
        }

        .info-row {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }

        .info-row div {
            flex: 1;
        }

        label {
            font-weight: bold;
        }

        input[type="text"], textarea, select {
            width: 100%;
            padding: 6px 8px;
            margin-top: 4px;
            box-sizing: border-box;
        }

        textarea {
            resize: vertical;
            height: 80px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
            margin-bottom: 20px;
        }

        table th, table td {
            border: 1px solid #dddddd;
            padding: 8px;
            text-align: center;
        }

        table th:first-child, table td:first-child {
            text-align: left;
        }

        th {
            background-color: #f0f0f0;
        }

        .score-label {
            font-size: 0.9em;
        }

        .total-row {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 10px;
        }

        .total-row input[type="number"] {
            width: 100px;
            padding: 5px;
        }

        .button-row {
            margin-top: 10px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        button {
            padding: 8px 16px;
            font-size: 14px;
            border-radius: 4px;
            border: none;
            cursor: pointer;
            background-color: #4CAF50;
            color: #ffffff;
        }

        button:hover {
            background-color: #45a049;
        }

        .submit-btn {
            background-color: #2196F3;
        }

        .submit-btn:hover {
            background-color: #1976D2;
        }

        .note {
            font-size: 0.9em;
            color: #555;
            margin-top: 5px;
        }

        .panel-section {
            margin-top: 25px;
            padding: 15px;
            background-color: #fafafa;
            border: 1px solid #ddd;
            border-radius: 6px;
        }

        .status {
            margin-top: 10px;
            font-size: 0.9em;
        }

        .status.success {
            color: #2e7d32;
        }

        .status.error {
            color: #c62828;
        }
    </style>
</head>
<body>

<form id="rubricForm">
    <h1>Business Pitch Scoring Rubric</h1>

    <!-- Judge / Team Info -->
    <div class="info-row">
		<div>
            <label for="judgeName">Judge Name</label>
            <select id="judgeName" name="judgeName">
                <option value="">-- Select Judge --</option>
                <option value="Dena Billups">Dena Billups</option>
                <option value="Jason Billups">Jason Billups</option>
                <option value="Dr. Tina Burns">Dr. Tina Burns</option>
                <option value="Linda Soto">Linda Soto</option>
                <option value="Keith Whaley">Keith Whaley</option>
            </select>
        </div>
      
		<div>
            <label for="teamName">Team / Business Name</label>
            <select id="teamName" name="teamName">
                <option value="">-- Select Team --</option>
                <option value="Heritage Bazaar">Heritage Bazaar</option>
                <option value="LockerRoom">LockerRoom</option>
                <option value="Thryve">Thryve</option>
                <option value="ReVolt">ReVolt</option>
                <option value="Camp Out">Camp Out</option>
				<option value="Sol">Sol</option>
            </select>
        </div>
    </div>

    <!-- Scoring Rubric Table -->
    <table>
        <thead>
            <tr>
                <th>Category</th>
                <th>Excellent<br><span class="score-label">(5)</span></th>
                <th>Good<br><span class="score-label">(4)</span></th>
                <th>Fair<br><span class="score-label">(3)</span></th>
                <th>Poor<br><span class="score-label">(2)</span></th>
                <th>Needs Improvement<br><span class="score-label">(1)</span></th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>Clarity of Business Concept</td>
                <td><input type="radio" name="clarity" value="5"></td>
                <td><input type="radio" name="clarity" value="4"></td>
                <td><input type="radio" name="clarity" value="3"></td>
                <td><input type="radio" name="clarity" value="2"></td>
                <td><input type="radio" name="clarity" value="1"></td>
            </tr>
            <tr>
                <td>Organization &amp; Role Clarity</td>
                <td><input type="radio" name="organization" value="5"></td>
                <td><input type="radio" name="organization" value="4"></td>
                <td><input type="radio" name="organization" value="3"></td>
                <td><input type="radio" name="organization" value="2"></td>
                <td><input type="radio" name="organization" value="1"></td>
            </tr>
            <tr>
                <td>Leadership &amp; Culture</td>
                <td><input type="radio" name="leadership" value="5"></td>
                <td><input type="radio" name="leadership" value="4"></td>
                <td><input type="radio" name="leadership" value="3"></td>
                <td><input type="radio" name="leadership" value="2"></td>
                <td><input type="radio" name="leadership" value="1"></td>
            </tr>
            <tr>
                <td>Marketing &amp; Creativity</td>
                <td><input type="radio" name="marketing" value="5"></td>
                <td><input type="radio" name="marketing" value="4"></td>
                <td><input type="radio" name="marketing" value="3"></td>
                <td><input type="radio" name="marketing" value="2"></td>
                <td><input type="radio" name="marketing" value="1"></td>
            </tr>
            <tr>
                <td>Financial Feasibility</td>
                <td><input type="radio" name="financial" value="5"></td>
                <td><input type="radio" name="financial" value="4"></td>
                <td><input type="radio" name="financial" value="3"></td>
                <td><input type="radio" name="financial" value="2"></td>
                <td><input type="radio" name="financial" value="1"></td>
            </tr>
            <tr>
                <td>Presentation Skills</td>
                <td><input type="radio" name="presentation" value="5"></td>
                <td><input type="radio" name="presentation" value="4"></td>
                <td><input type="radio" name="presentation" value="3"></td>
                <td><input type="radio" name="presentation" value="2"></td>
                <td><input type="radio" name="presentation" value="1"></td>
            </tr>
            <tr>
                <td>Q&amp;A Responses</td>
                <td><input type="radio" name="qa" value="5"></td>
                <td><input type="radio" name="qa" value="4"></td>
                <td><input type="radio" name="qa" value="3"></td>
                <td><input type="radio" name="qa" value="2"></td>
                <td><input type="radio" name="qa" value="1"></td>
            </tr>
        </tbody>
    </table>

    <!-- Total Score -->
    <div class="total-row">
        <label for="totalScore">Score out of 35:</label>
        <input type="number" id="totalScore" name="totalScore" readonly min="0" max="35">
    </div>

    <div class="button-row">
        <button type="button" onclick="calculateTotal()">Calculate Total</button>
        <button type="submit" class="submit-btn">Submit &amp; Save to Drive</button>
    </div>

    <hr style="margin: 30px 0;">

    <!-- Panel Questions Section -->
    <h2>Suggested Panel Questions</h2>
    
	<div class="panel-section">
        <label for="notes"><strong>General Notes</strong></label>
        <textarea id="notes" name="notes" placeholder="Enter any general feedback, observations, or comments here..."></textarea>
    </div>

    <div class="panel-section">
        <label><strong>Panel Question 1</strong></label>
        <select name="panelQ1">
            <option value="">-- Choose a question --</option>
            <option>How did you decide on your business idea?</option>
            <option>What was the biggest challenge in creating your plan?</option>
            <option>How did you determine and assign team roles?</option>
            <option>Which management concepts were most useful as you built your plan?</option>
            <option>How do you plan to measure success in your first year?</option>
            <option>What sets your business apart from competitors?</option>
            <option>If given more time/resources, what would you change or add to your business plan?</option>
            <option>How will you adapt if your plan doesn’t go as expected?</option>
        </select>
        <textarea name="panelA1" placeholder="Panelist response..."></textarea>
    </div>

    <div class="panel-section">
        <label><strong>Panel Question 2</strong></label>
        <select name="panelQ2">
            <option value="">-- Choose a question --</option>
            <option>How did you decide on your business idea?</option>
            <option>What was the biggest challenge in creating your plan?</option>
            <option>How did you determine and assign team roles?</option>
            <option>Which management concepts were most useful as you built your plan?</option>
            <option>How do you plan to measure success in your first year?</option>
            <option>What sets your business apart from competitors?</option>
            <option>If given more time/resources, what would you change or add to your business plan?</option>
            <option>How will you adapt if your plan doesn’t go as expected?</option>
        </select>
        <textarea name="panelA2" placeholder="Panelist response..."></textarea>
    </div>

    <div class="panel-section">
        <label><strong>Panel Question 3</strong></label>
        <select name="panelQ3">
            <option value="">-- Choose a question --</option>
            <option>How did you decide on your business idea?</option>
            <option>What was the biggest challenge in creating your plan?</option>
            <option>How did you determine and assign team roles?</option>
            <option>Which management concepts were most useful as you built your plan?</option>
            <option>How do you plan to measure success in your first year?</option>
            <option>What sets your business apart from competitors?</option>
            <option>If given more time/resources, what would you change or add to your business plan?</option>
            <option>How will you adapt if your plan doesn’t go as expected?</option>
			<option>Other?</option>

        </select>
        <textarea name="panelA3" placeholder="Panelist response..."></textarea>
    </div>

    <p class="note">
        Note: Panelists may choose up to 3 questions and write their responses.
    </p>

    <div id="status" class="status"></div>
</form>

<script>
    // Replace this with your deployed Google Apps Script Web App URL
    //const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbzCn25HiyX5NN9sORyNMVeTCrsnuZc8ZdIw8EYxo-ExKkvdE6oYMHSPLvpbw61Whcao/exec";
	const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbyCuMv6n3aPkyM-X7hFLO3JWVRzzLcHYHvftKS7gvB4hT4Ry4UG-9W5YHzH-spOsErQ/exec"

    // Calculate total score
    function calculateTotal() {
        const fields = [
            "clarity",
            "organization",
            "leadership",
            "marketing",
            "financial",
            "presentation",
            "qa"
        ];

        let total = 0;
        let missing = [];

        fields.forEach(function(field) {
            const selected = document.querySelector('input[name="' + field + '"]:checked');
            if (selected) {
                total += Number(selected.value);
            } else {
                missing.push(field);
            }
        });

        document.getElementById("totalScore").value = total;

        if (missing.length > 0) {
            alert("Some categories have no score selected.\n\nMissing: " + missing.join(", "));
        }
    }

    // Handle submit: send data to Google Apps Script
    document.getElementById('rubricForm').addEventListener('submit', function(e) {
        e.preventDefault();

        // Ensure total is calculated
        if (!document.getElementById("totalScore").value) {
            calculateTotal();
        }

        const judgeName = document.getElementById("judgeName").value || "";
        const teamName  = document.getElementById("teamName").value || "";
        const totalScore = document.getElementById("totalScore").value || "0";

        function getRadio(name) {
            const sel = document.querySelector('input[name="' + name + '"]:checked');
            return sel ? sel.value : "";
        }

        const payload = {
            judgeName,
            teamName,
            clarity:       getRadio("clarity"),
            organization:  getRadio("organization"),
            leadership:    getRadio("leadership"),
            marketing:     getRadio("marketing"),
            financial:     getRadio("financial"),
            presentation:  getRadio("presentation"),
            qa:            getRadio("qa"),
            panelQ1:       document.querySelector("select[name='panelQ1']").value || "",
            panelA1:       document.querySelector("textarea[name='panelA1']").value || "",
            panelQ2:       document.querySelector("select[name='panelQ2']").value || "",
            panelA2:       document.querySelector("textarea[name='panelA2']").value || "",
            panelQ3:       document.querySelector("select[name='panelQ3']").value || "",
            panelA3:       document.querySelector("textarea[name='panelA3']").value || "",
            notes:         document.getElementById("notes").value || "",
            totalScore
        };

        const statusEl = document.getElementById("status");
        if (statusEl) {
            statusEl.textContent = "Saving summary to Google Drive...";
            statusEl.className = "status";
        }

        fetch(WEB_APP_URL, {
            method: "POST",
            mode: "no-cors",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify(payload)
        }).then(() => {
            // Reset form after successful submit
            document.getElementById('rubricForm').reset();
            document.getElementById("totalScore").value = "";

            if (statusEl) {
                statusEl.textContent = "Summary saved to Google Drive.";
                statusEl.className = "status success";
            }

            alert("Submission saved. Form has been cleared.");
        }).catch(err => {
            console.error(err);
            if (statusEl) {
                statusEl.textContent = "Error sending to Google Drive.";
                statusEl.className = "status error";
            }
        });
    });
</script>

</body>
</html>
